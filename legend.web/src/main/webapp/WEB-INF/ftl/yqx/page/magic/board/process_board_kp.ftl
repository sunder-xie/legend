<#include "yqx/layout/kb-header.ftl">
<base href="<%=basePath%>">
<!-- 样式引入区 start-->
<link rel="stylesheet" href="${BASE_PATH}/static/css/page/magic/workshop/process_board.css?16a139cba2dd2f4cebf76f2f49701c77"/>
<!-- 样式引入区 end-->
<div class="fluid-wrapper clearfix">
<#include "yqx/layout/kb-top.ftl">
<#include "yqx/layout/kb-aside.ftl">
    <div class="main">
        <div class="title clearfix">
            <p class="title_name fl">快喷线工序看板</p>
            <ul class="sumary fr">
                <li>全部（50）</li>
                <li><span class="icon-normal icon-sumary fl"></span>正常（25）</li>
                <li><span class="icon-edge icon-sumary fl"></span>临界（15）</li>
                <li><span class="icon-timeout icon-sumary fl"></span>超时（10）</li>
            </ul>
        </div>
        <div class="loadplate">
            <ul class="flow-col-4">
                <li class="flow-plate wait-plate">
                    <p class="plate-top b1">待修（14）</p>
                    <ul class="plate-list wait-list">
                        <li>
                            <span class="icon-wait icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待派工</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-wait icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待派工</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-wait icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待派工</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-wait icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待派工</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-wait icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待派工</p>
                            <p>等待：12小时12分</p>
                        </li>
                    </ul>
                </li>
                <li class="flow-plate mianqi-plate mianqi-page-plate">
                    <p class="plate-top b5">面漆（14）</p>
                    <ul class="plate-list mianqi-list mianqi-page-list">
                        <li>
                            <span class="icon-timeout icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-edge icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-normal icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-timeout icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-edge icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-normal icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-timeout icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-edge icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-normal icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                    </ul>
                    <div class="direction">
                        <span class="icon-down"></span>
                        <span class="icon-up"></span>
                    </div>
                </li>
                <li class="flow-plate complete-plate">
                    <p class="plate-top b7">完工（14）</p>
                    <ul class="plate-list complete-list">
                        <li>
                            <span class="icon-timeout icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-edge icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                        <li>
                            <span class="icon-normal icon-state"></span>
                            <P class="f14 c3">浙A LY344</P>
                            <p>接待员：罗永浩</p>
                            <p>等待：12小时12分</p>
                        </li>
                    </ul>
                </li>
            </ul>
            <div class="flow-col-1">
                <div class="interrupt-space"></div>
                <div class="interrupt">
                    <p class="plate-top c3 interrupt-top">中断（14）</p>
                    <div class="interrupt-center">
                        <div class="prev">
                            <span class="icon-prev"></span>
                        </div>
                        <ul class="plate-list interrupt-list">
                            <li>
                                <span class="icon-timeout icon-state"></span>
                                <P class="f14 c3">浙A LY344</P>
                                <p>接待员：罗永浩</p>
                                <p>等待：12小时12分</p>
                            </li>
                            <li>
                                <span class="icon-edge icon-state"></span>
                                <P class="f14 c3">浙A LY344</P>
                                <p>接待员：罗永浩</p>
                                <p>等待：12小时12分</p>
                            </li>
                            <li>
                                <span class="icon-normal icon-state"></span>
                                <P class="f14 c3">浙A LY344</P>
                                <p>接待员：罗永浩</p>
                                <p>等待：12小时12分</p>
                            </li>
                        </ul>
                        <div class="next">
                            <span class="icon-next"></span>
                        </div>
                    </div>
                </div>
                <div class="interrupt-space"></div>
            </div>
        </div>
    </div>
</div>
<!-- 表格数据模板 start -->
<script type="text/template" id="tablePaintTpl">

</script>
<#include "yqx/layout/kb-footer.ftl">

<!-- 脚本引入区 start -->
<script  src="${BASE_PATH}/static/js/page/magic/workshop/loadplate.js?01182b6d962ba5d117769fe5f9b9b657"></script>

<!-- 脚本引入区 end -->


<#--李谭写的demo-->
<div id="message">
</div>


<script type="text/javascript">
    var websocket = null;

    //判断当前浏览器是否支持WebSocket
    if('WebSocket' in window){
        websocket = new WebSocket("ws://localhost:8080/legend/websocket");
    }
    else{
        alert('Not support websocket')
    }

    //连接发生错误的回调方法
    websocket.onerror = function(){
        setMessageInnerHTML("error");
    };

    //    //连接成功建立的回调方法
    //    websocket.onopen = function(event){
    //        setMessageInnerHTML("open");
    //    }

    //接收到消息的回调方法
    websocket.onmessage = function(event){
        setMessageInnerHTML(event.data);
    }

    //    //连接关闭的回调方法
    //    websocket.onclose = function(){
    //        setMessageInnerHTML("close");
    //    }

    //监听窗口关闭事件，当窗口关闭时，主动去关闭websocket连接，防止连接还没断开就关闭窗口，server端会抛异常。
    window.onbeforeunload = function(){
        websocket.close();
    }

    //将消息显示在网页上
    function setMessageInnerHTML(innerHTML){
        document.getElementById('message').innerHTML += innerHTML + '<br/>';
    }

    //关闭连接
    function closeWebSocket(){
        websocket.close();
    }

    //发送消息
    function send(){
        var message = document.getElementById('text').value;
        websocket.send(message);
    }
</script>
